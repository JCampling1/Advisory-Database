{
  "schema_version": "1.4.0",
  "id": "GHSA-hhq3-ff78-jv3g",
  "modified": "2023-09-21T22:02:26Z",
  "published": "2022-10-12T12:00:27Z",
  "aliases": [
    "CVE-2022-37599"
  ],
  "summary": "loader-utils is vulnerable to Regular Expression Denial of Service (ReDoS)",
  "details": "The ReDoS flaw in webpack loader-utils could be exploited by an attacker to cause a denial of service attack. To mitigate this vulnerability, you should upgrade to webpack loader-utils version 1.4.2, 2.0.4, or 3.2.1 or higher.\n\nIf you are unable to upgrade to a patched version of webpack loader-utils, you can mitigate the vulnerability by implementing your own regular expression matching function. This function should be designed to be resistant to ReDoS attacks.\n\nHere are some tips for implementing a ReDoS-resistant regular expression matching function:\n\nAvoid using backtracking in your regular expressions.\nUse fixed-width character classes whenever possible.\nUse lazy quantifiers instead of greedy quantifiers.\nSet a timeout on your regular expression matching function.\nHere is an example of a ReDoS-resistant regular expression matching function in Python:\n\n```\nimport re\n\ndef match_regex(regex, string, timeout=1):\n  \"\"\"Matches a regular expression against a string, with a timeout.\n\n  Args:\n    regex: The regular expression to match.\n    string: The string to match against.\n    timeout: The maximum amount of time to spend matching the regular expression.\n\n  Returns:\n    True if the regular expression matches the string, False otherwise.\n  \"\"\"\n\n  regex = re.compile(regex, re.DOTALL)\n  start_time = time.time()\n  match = regex.match(string)\n  end_time = time.time()\n  if match and (end_time - start_time) <= timeout:\n    return True\n  else:\n    return False\n```\n\nYou can use this function to match regular expressions against strings in your application, and it will help to protect you from ReDoS attacks.\n\nIn addition to mitigating the ReDoS vulnerability in webpack loader-utils, you should also take steps to protect your application from other types of denial of service attacks. This includes implementing rate limiting and other measures to prevent attackers from flooding your application with requests.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "loader-utils"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "1.0.0"
            },
            {
              "fixed": "1.4.2"
            }
          ]
        }
      ]
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "loader-utils"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "2.0.0"
            },
            {
              "fixed": "2.0.4"
            }
          ]
        }
      ]
    },
    {
      "package": {
        "ecosystem": "npm",
        "name": "loader-utils"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "3.0.0"
            },
            {
              "fixed": "3.2.1"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2022-37599"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/issues/211"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/issues/216"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/commit/17cbf8fa8989c1cb45bdd2997aa524729475f1fa"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/commit/ac09944dfacd7c4497ef692894b09e63e09a5eeb"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/commit/d2d752d59629daee38f34b24307221349c490eb1"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/webpack/loader-utils"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/blob/d9f4e23cf411d8556f8bac2d3bf05a6e0103b568/lib/interpolateName.js#L38"
    },
    {
      "type": "WEB",
      "url": "https://github.com/webpack/loader-utils/blob/d9f4e23cf411d8556f8bac2d3bf05a6e0103b568/lib/interpolateName.js#L83"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-400",
      "CWE-79"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2022-11-15T21:03:46Z",
    "nvd_published_at": "2022-10-11T19:15:00Z"
  }
}