{
  "schema_version": "1.4.0",
  "id": "GHSA-9xfw-jjq2-7v8h",
  "modified": "2024-02-05T20:19:32Z",
  "published": "2024-02-05T20:19:30Z",
  "aliases": [
    "CVE-2024-24768"
  ],
  "summary": "Inadequate Secure Flag in 1Panel Set-Cookie Implementation",
  "details": "### Summary\nAn examination of the 1Panel's HTTPS configuration reveals a critical oversight in cookie security. Specifically, the absence of the Secure attribute in set-cookie headers compromises data integrity by allowing cookies to be transmitted over unencrypted connections (HTTP), contrary to best practices as outlined in the [Mozilla Developer Network (MDN) documentation](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Set-Cookie#secure).\n\nhttps://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Set-Cookie#secure\n\n### PoC\nConfiguring the 1Panel with HTTPS and subsequent packet capture during user login sessions unequivocally demonstrates the lack of the Secure keyword in cookie transmissions, thus exposing sensitive user data to potential interception.\n\n### Impact\nThis vulnerability presents a significant risk to all 1Panel HTTPS configurations, potentially leading to unauthorized access to session cookies and other sensitive information through unsecured network communication channels.\n\n### Severity Assessment\nModerate severity with a CVSS score of 6.5, based on the following vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L. This assessment underscores the vulnerability's considerable impact on confidentiality and integrity, albeit with some limitations in attack complexity and user interaction requirements.\n\n### Mitigation Recommendations\nUsers are urged to upgrade to version 1.9.6 at the earliest convenience to mitigate the identified risk. Additionally, developers should ensure that all cookies set by the application explicitly include the Secure attribute to enforce encrypted transmission, thereby aligning with [security best practices](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Set-Cookie#secure).\n",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:L"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "Go",
        "name": "github.com/1Panel-dev/1Panel"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.9.6"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 1.9.5"
      }
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-9xfw-jjq2-7v8h"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-24768"
    },
    {
      "type": "WEB",
      "url": "https://github.com/1Panel-dev/1Panel/pull/3817"
    },
    {
      "type": "WEB",
      "url": "https://github.com/1Panel-dev/1Panel/commit/1169648162c4b9b48e0b4aa508f9dea4d6bc50d5"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/1Panel-dev/1Panel"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-315"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2024-02-05T20:19:30Z",
    "nvd_published_at": "2024-02-05T15:15:09Z"
  }
}