{
  "schema_version": "1.4.0",
  "id": "GHSA-mpwj-fcr6-x34c",
  "modified": "2024-02-05T20:20:30Z",
  "published": "2024-02-04T21:30:43Z",
  "aliases": [
    "CVE-2021-4435"
  ],
  "summary": "Enhanced Mitigation for Yarn Untrusted Search Path Vulnerability",
  "details": "### Summary\n\nA significant security vulnerability has been identified in Yarn, the popular package manager for the Node ecosystem. This vulnerability stems from an untrusted search path issue, whereby executing Yarn commands within a directory containing attacker-modified content could inadvertently trigger the execution of malicious commands. The risk associated with this vulnerability underscores the necessity for immediate attention and remediation by all Yarn users.\n\n### Technical Details\n**Ecosystem**: npm\n**Package Name**: yarn\n**Affected Versions**: Versions prior to 1.22.13\n**Patched Version**: 1.22.13\n\n\n### Vulnerability Analysis\nThe vulnerability leverages the manner in which Yarn processes commands within directories that may contain maliciously crafted files. An attacker can exploit this by inducing the victim to run Yarn commands in such a directory, leading to unauthorized command execution.\n\n### Severity Assessment\nAssigned a CVSS score of 7.7, this vulnerability is classified as High severity, with specific vector string: CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H. This rating reflects the significant potential impact on confidentiality, integrity, and availability.\n\n### Mitigation Recommendations\nTo address this vulnerability, users must update Yarn to version 1.22.13, which includes necessary security patches to mitigate the risk. Additionally, users are advised to exercise caution and verify the safety of directories before executing Yarn commands, especially in shared or potentially compromised environments.",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "npm",
        "name": "yarn"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "fixed": "1.22.13"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-4435"
    },
    {
      "type": "WEB",
      "url": "https://github.com/yarnpkg/yarn/commit/67fcce88935e45092ffa2674c08053f1ef5268a1"
    },
    {
      "type": "WEB",
      "url": "https://access.redhat.com/security/cve/CVE-2021-4435"
    },
    {
      "type": "WEB",
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2262284"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/yarnpkg/yarn"
    },
    {
      "type": "WEB",
      "url": "https://github.com/yarnpkg/yarn/releases/tag/v1.22.13"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-20",
      "CWE-200",
      "CWE-284",
      "CWE-426",
      "CWE-427",
      "CWE-94"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2024-02-05T20:20:29Z",
    "nvd_published_at": "2024-02-04T20:15:45Z"
  }
}