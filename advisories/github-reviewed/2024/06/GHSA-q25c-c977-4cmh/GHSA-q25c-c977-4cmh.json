{
  "schema_version": "1.4.0",
  "id": "GHSA-q25c-c977-4cmh",
  "modified": "2024-06-06T22:41:07Z",
  "published": "2024-06-06T21:30:36Z",
  "aliases": [
    "CVE-2024-3095"
  ],
  "summary": "Server-Side Request Forgery in langchain",
  "details": "## Advisory: SSRF Vulnerability in Web Research Retriever\n\n### Affected Component\n- **Component**: Web Research Retriever\n- **Version**: langchain-ai/langchain version 0.1.5\n\n### Description\nA Server-Side Request Forgery (SSRF) vulnerability exists in the Web Research Retriever component. The vulnerability arises because the Web Research Retriever does not restrict requests to remote internet addresses, allowing it to reach local addresses.\n\n### Impact\nThis flaw enables attackers to:\n- Execute port scans\n- Access local services\n- Read instance metadata from cloud environments\n\nThe vulnerability is particularly concerning as it can be exploited to:\n- Abuse the Web Explorer server as a proxy for web attacks on third parties\n- Interact with servers in the local network, including reading their response data\n\n### Potential Consequences\n- **Arbitrary Code Execution**: Depending on the nature of the local services.\n- **Confidentiality**: Potential for stolen credentials.\n- **Integrity**: State-changing interactions with internal APIs.\n- **Availability**: Significant impact due to the potential for stolen credentials and state-changing interactions.\n\n### Limitations\n- The vulnerability is limited to GET requests, as POST requests are not possible.\n\n### Example Code\n\n```py\nfrom langchain.retrievers.web_research import WebResearchRetriever\nfrom langchain_chroma import Chroma\nfrom langchain_openai import ChatOpenAI, OpenAIEmbeddings\nfrom langchain.chains import RetrievalQAWithSourcesChain\nfrom langchain_community.utilities import GoogleSearchAPIWrapper\n\nvectorstore = Chroma(embedding_function=OpenAIEmbeddings(), persist_directory=\"./db\")\nsearch = GoogleSearchAPIWrapper()\n\nretriever = WebResearchRetriever.from_llm(vectorstore=vectorstore, llm=ChatOpenAI(), search=search)\nllm = ChatOpenAI()\nchain = RetrievalQAWithSourcesChain.from_chain_type(llm, retriever=retriever)\n\nresponse = chain(\"Tell me about this website: https://localhost:8000\")\n```\n",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.0/AV:P/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "PyPI",
        "name": "langchain"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0"
            },
            {
              "last_affected": "0.1.5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-3095"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/langchain-ai/langchain"
    },
    {
      "type": "WEB",
      "url": "https://huntr.com/bounties/e62d4895-2901-405b-9559-38276b6a5273"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-918"
    ],
    "severity": "MODERATE",
    "github_reviewed": true,
    "github_reviewed_at": "2024-06-06T22:41:06Z",
    "nvd_published_at": "2024-06-06T19:15:59Z"
  }
}